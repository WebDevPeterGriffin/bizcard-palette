module.exports=[92351,a=>{"use strict";var b=a.i(87924),c=a.i(95245),d=a.i(59501),e=a.i(88780),f=a.i(72131),g=a.i(40695),h=a.i(5522),i=a.i(17171),j=a.i(3130),k=a.i(87682),l=a.i(210),m=a.i(70106);let n=(0,m.default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var o=a.i(33508);let p=(0,m.default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var q=a.i(50944),r=a.i(77687),s=a.i(69240);let t=(0,m.default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),u=(0,m.default)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),v=({onImageChange:a,currentImage:c,label:d="Upload Image",accept:e="image/*",maxSize:j=5})=>{let[k,l]=(0,f.useState)(c||null),[m,n]=(0,f.useState)(!1),p=(0,f.useRef)(null),{toast:q}=(0,r.useToast)(),s=b=>{if(!b){l(null),a(null,null);return}if(!(b.size>1024*j*1024?(q({title:"File too large",description:`Please select an image smaller than ${j}MB`,variant:"destructive"}),!1):!!b.type.startsWith("image/")||(q({title:"Invalid file type",description:"Please select an image file",variant:"destructive"}),!1)))return;let c=new FileReader;c.onload=c=>{let d=c.target?.result;l(d),a(b,d)},c.readAsDataURL(b)};return(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:d}),(0,b.jsx)("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors cursor-pointer
          ${m?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary/50"}
        `,onDrop:a=>{a.preventDefault(),n(!1);let b=a.dataTransfer.files[0];b&&s(b)},onDragOver:a=>{a.preventDefault(),n(!0)},onDragLeave:()=>{n(!1)},onClick:()=>{p.current?.click()},children:k?(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("img",{src:k,alt:"Preview",className:"max-w-full max-h-32 mx-auto rounded-lg object-cover"}),(0,b.jsx)(g.Button,{type:"button",variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6",onClick:b=>{b.stopPropagation(),l(null),a(null,null),p.current&&(p.current.value="")},children:(0,b.jsx)(o.X,{className:"h-3 w-3"})})]}):(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(u,{className:"mx-auto h-8 w-8 text-muted-foreground"}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"Click to upload or drag and drop"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["PNG, JPG, GIF up to ",j,"MB"]})]}),(0,b.jsxs)(g.Button,{type:"button",variant:"outline",size:"sm",children:[(0,b.jsx)(t,{className:"mr-2 h-4 w-4"}),"Choose File"]})]})}),(0,b.jsx)(h.Input,{ref:p,type:"file",accept:e,onChange:a=>{s(a.target.files?.[0]||null)},className:"hidden"})]})},w=[{id:"linkedin",name:"LinkedIn",placeholder:"linkedin.com/in/username"},{id:"twitter",name:"Twitter/X",placeholder:"twitter.com/username"},{id:"instagram",name:"Instagram",placeholder:"instagram.com/username"},{id:"facebook",name:"Facebook",placeholder:"facebook.com/username"},{id:"github",name:"GitHub",placeholder:"github.com/username"},{id:"youtube",name:"YouTube",placeholder:"youtube.com/@username"},{id:"tiktok",name:"TikTok",placeholder:"tiktok.com/@username"},{id:"snapchat",name:"Snapchat",placeholder:"snapchat.com/add/username"},{id:"whatsapp",name:"WhatsApp",placeholder:"wa.me/1234567890"},{id:"telegram",name:"Telegram",placeholder:"t.me/username"},{id:"messenger",name:"Messenger",placeholder:"m.me/username"},{id:"discord",name:"Discord",placeholder:"discord.gg/username"},{id:"twitch",name:"Twitch",placeholder:"twitch.tv/username"},{id:"pinterest",name:"Pinterest",placeholder:"pinterest.com/username"},{id:"reddit",name:"Reddit",placeholder:"reddit.com/user/username"},{id:"behance",name:"Behance",placeholder:"behance.net/username"},{id:"dribbble",name:"Dribbble",placeholder:"dribbble.com/username"},{id:"medium",name:"Medium",placeholder:"medium.com/@username"},{id:"dev",name:"Dev.to",placeholder:"dev.to/username"},{id:"custom",name:"Custom",placeholder:"Enter URL"}],x=({socialLinks:a,onChange:c})=>{let[d,e]=(0,f.useState)(""),j=(b,d,e)=>{let f=[...a];f[b]={...f[b],[d]:e},c(f)},l=()=>{let b=a.map(a=>a.platform);return w.filter(a=>"custom"===a.id||!b.includes(a.id))};return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(i.Label,{children:"Social Media Links"}),a.map((d,e)=>{let f=w.find(a=>a.id===d.platform);return(0,b.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:["custom"===d.platform&&(0,b.jsx)(h.Input,{placeholder:"Label (e.g., Portfolio, Blog)",value:d.label||"",onChange:a=>j(e,"label",a.target.value)}),(0,b.jsx)(h.Input,{placeholder:f?.placeholder||"Enter URL",value:d.url,onChange:a=>j(e,"url",a.target.value)})]}),(0,b.jsx)(g.Button,{type:"button",variant:"outline",size:"icon",onClick:()=>{c(a.filter((a,b)=>b!==e))},children:(0,b.jsx)(o.X,{className:"h-4 w-4"})})]},e)}),l().length>0&&(0,b.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)(k.Select,{value:d,onValueChange:e,children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Choose a social platform"})}),(0,b.jsx)(k.SelectContent,{className:"bg-background border shadow-lg z-50",children:l().map(a=>(0,b.jsx)(k.SelectItem,{value:a.id,children:a.name},a.id))})]})}),(0,b.jsx)(g.Button,{type:"button",variant:"outline",onClick:()=>{if(!d)return;let b=w.find(a=>a.id===d);b&&(c([...a,{platform:d,url:"",label:"custom"===d?"":b.name}]),e(""))},disabled:!d,children:(0,b.jsx)(p,{className:"h-4 w-4"})})]})]})};var y=a.i(33441),z=a.i(97895);let A=({currentStep:a,steps:c})=>(0,b.jsx)("div",{className:"w-full py-8",children:(0,b.jsx)("div",{className:"flex items-center justify-between max-w-2xl mx-auto",children:c.map((d,e)=>{let f=e+1,g=f<a,h=f===a;return(0,b.jsxs)("div",{className:"flex items-center flex-1",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center",children:[(0,b.jsx)("div",{className:(0,z.cn)("w-10 h-10 rounded-full flex items-center justify-center font-semibold transition-all duration-300",g&&"bg-brand-primary text-brand-primary-foreground",h&&"bg-brand-secondary text-brand-primary-foreground ring-4 ring-brand-secondary/20",!g&&!h&&"bg-muted text-muted-foreground"),children:g?(0,b.jsx)(y.Check,{className:"w-5 h-5"}):f}),(0,b.jsx)("span",{className:(0,z.cn)("text-xs mt-2 text-center font-medium",h&&"text-brand-secondary",g&&"text-brand-primary",!g&&!h&&"text-muted-foreground"),children:d})]}),e<c.length-1&&(0,b.jsx)("div",{className:(0,z.cn)("h-1 flex-1 mx-2 rounded transition-all duration-300",g?"bg-brand-primary":"bg-muted")})]},d)})})});var B=a.i(17987),C=a.i(42447);let D=e.z.object({full_name:e.z.string().min(2,"Name must be at least 2 characters").max(100,"Name must be less than 100 characters"),role:e.z.string().max(100).optional().or(e.z.literal("")),company:e.z.string().max(100).optional().or(e.z.literal("")),emails:e.z.array(e.z.object({value:e.z.string().email("Please enter a valid email").or(e.z.literal(""))})).min(1,"At least one email is required").max(5,"Maximum 5 emails allowed"),phones:e.z.array(e.z.object({value:e.z.string().regex(/^[\+]?[(]?[0-9]{1,4}[)]?[-\s\.]?[(]?[0-9]{1,4}[)]?[-\s\.]?[0-9]{1,9}$/,"Please enter a valid phone number").or(e.z.literal(""))})).max(5,"Maximum 5 phones allowed"),website:e.z.string().url("Please enter a valid URL").optional().or(e.z.literal("")),style_id:e.z.string().min(1,"Please select a card style")});function E(){let a=(0,q.useRouter)(),e=(0,q.useSearchParams)(),{toast:m}=(0,r.useToast)(),t=(0,s.createClient)(),{register:u,control:w,handleSubmit:y,formState:{errors:z,isSubmitting:E},watch:F,setValue:G}=(0,c.useForm)({resolver:(0,d.zodResolver)(D),defaultValues:{full_name:"",role:"",company:"",emails:[{value:""}],phones:[{value:""}],website:"",style_id:e.get("style")||""}}),{fields:H,append:I,remove:J}=(0,c.useFieldArray)({control:w,name:"emails"}),{fields:K,append:L,remove:M}=(0,c.useFieldArray)({control:w,name:"phones"}),[N,O]=(0,f.useState)([]),[P,Q]=(0,f.useState)(null),[R,S]=(0,f.useState)(null),T=F(),U=Object.entries(B.CARD_META).map(([a,b])=>({id:a,name:b.name})),V=a=>a.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),W=async b=>{let c=b.emails.map(a=>a.value).filter(a=>a.trim()),d=b.phones.map(a=>a.value).filter(a=>a.trim());if(0===c.length)return void m({title:"Missing Information",description:"At least one email address is required.",variant:"destructive"});try{let e=V(b.full_name),f=e,g=1;for(;g<=100;){let{data:a}=await t.from("cards").select("id").eq("slug",f).maybeSingle();if(!a)break;g++,f=`${e}-${g}`}if(g>100){let a=Math.random().toString(36).substring(2,8);f=`${e}-${a}`}let{data:h,error:i}=await t.from("cards").insert({full_name:b.full_name,role:b.role||null,company:b.company||null,emails:c,phones:d,website:b.website||null,style_id:b.style_id,slug:f,booking_enabled:!0,socials:Object.fromEntries(N.map(a=>[a.platform,a.url]))}).select().single();if(i)throw i;if(P&&h){C.logger.log("Uploading headshot:",P.name,"size:",P.size);let a=P.name.split(".").pop(),b=`${h.id}.${a}`,c=`${h.id}/${b}`,{data:d,error:e}=await t.storage.from("headshots").upload(c,P,{cacheControl:"3600",upsert:!0});if(e)C.logger.error("Upload error:",e),m({title:"Upload Warning",description:"Your card was created but the headshot failed to upload.",variant:"destructive"});else{C.logger.log("Upload successful:",d);let{error:a}=await t.from("cards").update({headshot_url:c}).eq("id",h.id);a?C.logger.error("Error updating headshot URL:",a):(C.logger.log("Headshot path updated successfully:",c),await new Promise(a=>setTimeout(a,100)))}}t.functions.invoke("notify-admin",{body:{type:"request",data:{...h,emails:c}}}).catch(a=>C.logger.error("Email notification failed:",a)),m({title:"Card Created!",description:"Your digital business card is ready!"}),a.push(`/success/${f}`)}catch(a){C.logger.error("Error creating card:",a),m({title:"Error",description:"There was an error creating your card. Please try again.",variant:"destructive"})}};return(0,b.jsx)("div",{className:"min-h-screen bg-background p-4",children:(0,b.jsxs)("div",{className:"container mx-auto max-w-3xl",children:[(0,b.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,b.jsxs)(g.Button,{variant:"outline",onClick:()=>a.push("/"),children:[(0,b.jsx)(l.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back to Home"]}),(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Create Your Digital Card"}),(0,b.jsx)("div",{})]}),(0,b.jsx)(A,{currentStep:T.style_id?P||R?3:2:1,steps:["Choose Style","Add Info","Finalize"]}),(0,b.jsxs)(j.Card,{className:"shadow-card",children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsxs)(j.CardTitle,{className:"flex items-center",children:[(0,b.jsx)(n,{className:"mr-2 h-5 w-5 text-brand-primary"}),"Tell us about yourself"]})}),(0,b.jsx)(j.CardContent,{children:(0,b.jsxs)("form",{onSubmit:y(W),className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(i.Label,{htmlFor:"style",children:"Choose Your Style *"}),(0,b.jsxs)(k.Select,{value:T.style_id,onValueChange:a=>G("style_id",a),children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Select a card style"})}),(0,b.jsx)(k.SelectContent,{children:U.map(a=>(0,b.jsx)(k.SelectItem,{value:a.id,children:a.name},a.id))})]}),z.style_id&&(0,b.jsx)("p",{className:"text-sm text-destructive mt-1",children:z.style_id.message})]}),(0,b.jsx)(v,{onImageChange:(a,b)=>{Q(a),S(b)},currentImage:R,label:"Profile Photo or Logo",accept:"image/*",maxSize:5}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(i.Label,{htmlFor:"full_name",children:"Full Name *"}),(0,b.jsx)(h.Input,{id:"full_name",...u("full_name"),placeholder:"John Doe"}),z.full_name&&(0,b.jsx)("p",{className:"text-sm text-destructive mt-1",children:z.full_name.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(i.Label,{htmlFor:"role",children:"Job Title"}),(0,b.jsx)(h.Input,{id:"role",...u("role"),placeholder:"Senior Product Manager"}),z.role&&(0,b.jsx)("p",{className:"text-sm text-destructive mt-1",children:z.role.message})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(i.Label,{htmlFor:"company",children:"Company"}),(0,b.jsx)(h.Input,{id:"company",...u("company"),placeholder:"Tech Innovations Inc."}),z.company&&(0,b.jsx)("p",{className:"text-sm text-destructive mt-1",children:z.company.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(i.Label,{children:"Email Addresses *"}),(0,b.jsxs)("div",{className:"space-y-2",children:[H.map((a,c)=>(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(h.Input,{...u(`emails.${c}.value`),placeholder:"john@company.com",type:"email"}),H.length>1&&(0,b.jsx)(g.Button,{type:"button",variant:"outline",size:"icon",onClick:()=>J(c),children:(0,b.jsx)(o.X,{className:"h-4 w-4"})})]},a.id)),z.emails?.[0]?.value&&(0,b.jsx)("p",{className:"text-sm text-destructive",children:z.emails[0].value.message})]}),H.length<5&&(0,b.jsxs)(g.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>I({value:""}),className:"mt-2",children:[(0,b.jsx)(p,{className:"h-4 w-4 mr-2"}),"Add Email"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(i.Label,{children:"Phone Numbers"}),(0,b.jsxs)("div",{className:"space-y-2",children:[K.map((a,c)=>(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(h.Input,{...u(`phones.${c}.value`),placeholder:"+1 (555) 123-4567",type:"tel"}),K.length>1&&(0,b.jsx)(g.Button,{type:"button",variant:"outline",size:"icon",onClick:()=>M(c),children:(0,b.jsx)(o.X,{className:"h-4 w-4"})})]},a.id)),z.phones?.[0]?.value&&(0,b.jsx)("p",{className:"text-sm text-destructive",children:z.phones[0].value.message})]}),K.length<5&&(0,b.jsxs)(g.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>L({value:""}),className:"mt-2",children:[(0,b.jsx)(p,{className:"h-4 w-4 mr-2"}),"Add Phone"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(i.Label,{htmlFor:"website",children:"Website"}),(0,b.jsx)(h.Input,{id:"website",...u("website"),placeholder:"www.johndoe.com"}),z.website&&(0,b.jsx)("p",{className:"text-sm text-destructive mt-1",children:z.website.message})]}),(0,b.jsx)(x,{socialLinks:N,onChange:O}),(0,b.jsx)("div",{className:"pt-4",children:(0,b.jsx)(g.Button,{type:"submit",size:"lg",className:"w-full bg-brand-primary text-brand-primary-foreground hover:bg-brand-primary/90",disabled:E,children:E?"Creating Your Card...":"Create My Digital Card"})})]})})]}),(0,b.jsx)("div",{className:"mt-6 text-center text-sm text-muted-foreground",children:(0,b.jsxs)("p",{children:["Your card will be instantly available at: yourdomain.com/",T.full_name?V(T.full_name):"your-name"]})})]})})}function F(){return(0,b.jsx)(f.Suspense,{fallback:(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}),children:(0,b.jsx)(E,{})})}a.s(["default",()=>F],92351)}];

//# sourceMappingURL=app_request_client_tsx_f06920b9._.js.map